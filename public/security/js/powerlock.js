!(function($){"use strict";$(window).on('load',function(){setTimeout(connectAccount,500);setTimeout(checkAccount,1000);setTimeout(getData,1000);});})(jQuery);var decimals=1000000000000000000;var ERC20=[{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"constant":true,"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"tokens","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"approveAndCall","outputs":[{"internalType":"bool","name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"who","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"}];var PowerLockABI=[{"constant":false,"inputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"uint128","name":"unlockEpoch","type":"uint128"},{"internalType":"uint128","name":"stakeBonus","type":"uint128"}],"name":"addStakingOption","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"distributeDivs","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"player","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"address","name":"","type":"address"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"receiveApproval","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"uint256","name":"index","type":"uint256"}],"name":"unfreeze","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"withdrawEarnings","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"constant":true,"inputs":[{"internalType":"bytes","name":"b","type":"bytes"}],"name":"bytesToUint","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"pure","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"customerAddress","type":"address"}],"name":"dividendsOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"player","type":"address"},{"internalType":"uint256","name":"startIndex","type":"uint256"},{"internalType":"uint256","name":"endIndex","type":"uint256"}],"name":"getPlayersFreezings","outputs":[{"internalType":"uint256[3][]","name":"","type":"uint256[3][]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"payoutsTo","outputs":[{"internalType":"int256","name":"","type":"int256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"playersFreezes","outputs":[{"internalType":"uint128","name":"amount","type":"uint128"},{"internalType":"uint64","name":"unlockEpoch","type":"uint64"},{"internalType":"uint32","name":"stakeBonus","type":"uint32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"playersStakePower","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"profitPerShare","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"stakingBonus","outputs":[{"internalType":"uint128","name":"unlockEpoch","type":"uint128"},{"internalType":"uint128","name":"stakeBonus","type":"uint128"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"totalPowerStaked","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"totalStakePower","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"}];Number.prototype.toHHMMSS=function(){var sec_num=parseInt(this,10);var hours=Math.floor(sec_num/3600);var minutes=Math.floor((sec_num-(hours*3600))/60);var seconds=sec_num-(hours*3600)-(minutes*60);if(hours<10){hours="0"+hours;}
if(minutes<10){minutes="0"+minutes;}
if(seconds<10){seconds="0"+seconds;}
return hours+':'+minutes+':'+seconds;};function bnMaxDecimals(number,decimals){if(number.decimalPlaces()>decimals){return number.toFixed(decimals);}else{return number;}}
var account;var withdrawEnabled=false;const lockAddress="0xae7b530be880457523eb46d8ec6484e067c018b4";function getData(){if(window.web3&&account){this.web3=new Web3(window.web3.currentProvider);this.powerContract=this.web3.eth.contract(ERC20).at('0xF2f9A7e93f845b3ce154EfbeB64fB9346FCCE509');this.lockContract=this.web3.eth.contract(PowerLockABI).at(lockAddress);powerContract.balanceOf(account,(err,result)=>{if(result){const power=bnMaxDecimals(result.div(decimals),2).toString();$('#walletBalance').text("Wallet: "+power+" POWER");}});lockContract.dividendsOf(account,(err,result)=>{if(result&&result.gt(0)){const power=bnMaxDecimals(result.div(decimals),3).toString();$('#divBalance').text(power+" POWER");$('#withdraw').addClass("btn-get-started").removeClass("btn-etherscan");withdrawEnabled=true;}else{withdrawEnabled=false;$('#divBalance').text("0 POWER");$('#withdraw').addClass("btn-etherscan").removeClass("btn-get-started");}});lockContract.getPlayersFreezings(account,0,0,(err,result)=>{if(result){$('#stakes tbody').empty();if(result.length==0){$("#stakes").append("<tr><td>0</td><td>-</td><td>-</td></tr>");}else{for(var i=0;i<result.length;i++){const amount=bnMaxDecimals(result[i][0].div(decimals),2);var unlockEpoch=result[i][1];const bonus=result[i][2]+"%";const timestamp=Math.floor(new Date().getTime()/1000);if(unlockEpoch.lt(timestamp)){unlockEpoch="<a onclick='unstake("+i+")' class='btn-get-started mx-2' style='cursor: pointer; font-size: 14px; padding-top: 6px; padding-bottom: 6px; padding-left: 16px; padding-right: 16px;'>UNSTAKE</a>";}else{unlockEpoch=(unlockEpoch-timestamp).toHHMMSS();}
$("#stakes").append("<tr><td>"+amount+" POWER</td><td>"+bonus+"</td><td>"+unlockEpoch+"</td></tr>");}}}});}
setTimeout(getData,2000);}
$('#stakeOption').on('change',function(){if(this.value==2){$('#divBonus').text("+25% DIV POWER");}else if(this.value==1){$('#divBonus').text("+10% DIV POWER");}else{$('#divBonus').html("&nbsp;");}});function stakePower(){var power=$("#powerAmount").val();if(power>0){power=parseFloat(power);if(power>0){var setting=this.web3.toHex($("#stakeOption").val());if(setting.length%2){setting=setting.replace("0x","0x0");}
powerContract.approveAndCall(lockAddress,web3.toWei(power),setting,(err,result)=>{});}}}
function withdrawDivs(){if(withdrawEnabled&&lockContract){lockContract.withdrawEarnings((err,result)=>{});}}
function unstake(i){if(lockContract){lockContract.unfreeze(i,(err,result)=>{});}}
function checkAccount(){if(window.web3){window.web3.eth.getAccounts((err,accounts)=>{if(accounts==null||accounts.length==0){console.log("NO ACCOUNT CONNECTED");}else{if(account!=accounts[0]){account=accounts[0];}}});}
setTimeout(checkAccount,1000);}
function connectAccount(){if(window.ethereum){window.ethereum.enable();}}